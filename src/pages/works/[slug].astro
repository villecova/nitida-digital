---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/Navbar.astro';
import Footer from '../../components/Footer.astro';

export async function getStaticPaths() {
  const entries = await getCollection('work');
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { project: entry }, // opcional, si quieres pasarlo como prop
  }));
}

const { slug } = Astro.params;
const project = await getCollection('work').then((entries) =>
  entries.find((entry) => entry.slug === slug)
);
if (!project) throw new Error(`Project not found: ${slug}`);

const { title, description, year, client, scope, image, gallery = [] } = project.data;

---


<Layout>
	<Navbar client:load />

  <section class="max-w-screen-lg mx-auto px-4 py-12 space-y-12">
    <!-- Back link -->
    <a href="/works" class="inline-block text-sm text-gray-500 hover:underline">← All projects</a>
  
    <!-- Header info -->
    <div>
      <h1 class="text-4xl font-bold text-gray-900">{title}</h1>
      <p class="text-accent mt-2">{description}</p>
    </div>
  
    <!-- Metadata -->
    <div class="grid grid-cols-1 sm:grid-cols-3 text-sm text-gray-700 divide-y sm:divide-y-0 sm:divide-x border-t border-b py-4">
      <div class="py-2 sm:px-4"><strong>Año</strong><br />{year}</div>
      <div class="py-2 sm:px-4"><strong>Cliente</strong><br />{client}</div>
      <div class="py-2 sm:px-4"><strong>Alcance</strong><br />{scope}</div>
    </div>
  
    <!-- Imagen principal -->
    <div class="rounded-lg overflow-hidden shadow-md">
      <img src={image} alt={title} class="w-full h-auto" />
    </div>
  
    <!-- Galería adicional -->
    {gallery.length > 0 && (
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        {gallery.map((img) => (
          <img src={img} alt="Detalle del proyecto" class="rounded shadow" />
        ))}
      </div>
    )}
  
    <!-- Contenido Markdown -->
    {project.body && (
      <div class="prose max-w-none mt-8" set:html={project.body} />
    )}
  </section>
  

	<Footer client:load />
</Layout>




<!-- ---
import { getCollection } from 'astro:content';
import type { APIContext } from 'astro';

export async function getStaticPaths() {
  const entries = await getCollection('work');
  return entries.map((entry) => ({
    params: { slug: entry.slug },
    props: { project: entry }, // opcional, si quieres pasarlo como prop
  }));
}

const { slug } = Astro.params;
const project = await getCollection('work').then((entries) =>
  entries.find((entry) => entry.slug === slug)
);
if (!project) throw new Error(`Project not found: ${slug}`);
---

<main class="max-w-screen-md mx-auto p-8">
  <h1 class="text-4xl font-bold mb-4">{project.data.title}</h1>
  <img src={project.data.image} alt={project.data.title} class="mb-6 rounded" />
  <p class="mb-4 text-lg">{project.data.description}</p>
  <div class="prose" set:html={project.body} />
</main> -->

